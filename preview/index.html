
<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<!-- Open Graph -->
	<meta property="og:image" content="https://i.ibb.co/phGtLx1/blob.jpg">
	<title>LIFF Card Share</title>
	<!-- flex2html -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/PamornT/flex2html@main/css/flex2html.css">
	<script src="https://cdn.jsdelivr.net/gh/PamornT/flex2html@main/js/flex2html.min.js"></script>
	<!-- liff -->
	<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
	<!-- 提示框 -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@10.16.5/dist/sweetalert2.min.css">
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10.16.5/dist/sweetalert2.min.js"></script>
	<!-- dom-to-image -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/dom-to-image/2.6.0/dom-to-image.min.js"></script>

	<style>
		body {
			font-family: Arial, sans-serif;
		}

		.form-container {
			width: 310px;
			margin: 0 auto;
			padding: 20px;
			background-color: #f8f8f8;
			border-radius: 5px;
			box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
			overflow: hidden;
		}

		.form-group {
			margin-bottom: 15px;
		}

		label {
			position: relative;
			display: block;
			margin-bottom: 5px;
		}

		button {
			padding: 10px 20px;
			font-size: 16px;
			background-color: #009688;
			color: white;
			border: none;
			border-radius: 5px;
		}

		button:hover {
			background-color: #007c69;
		}

		.chatbox {
			background-color: transparent;
		}

		.hidden {
			display: none;
		}

		.loader {
			position: fixed;
			z-index: 9999;
			top: 0;
			left: 0;
			height: 100%;
			width: 100%;
			background: rgba(255, 255, 255, 0.8);
			display: none;
			justify-content: center;
			align-items: center;
		}

		.sk-chase {
			width: 70px;
			height: 70px;
			position: relative;
			animation: sk-chase 2.5s infinite linear both;
		}

		.sk-chase-dot {
			width: 100%;
			height: 100%;
			position: absolute;
			left: 0;
			top: 0;
			animation: sk-chase-dot 2.0s infinite ease-in-out both;
		}

		.sk-chase-dot:before {
			content: '';
			display: block;
			width: 25%;
			height: 25%;
			background-color: #009688;
			border-radius: 100%;
			animation: sk-chase-dot-before 2.0s infinite ease-in-out both;
		}

		.sk-chase-dot:nth-child(1) {
			animation-delay: -1.1s;
		}

		.sk-chase-dot:nth-child(2) {
			animation-delay: -1.0s;
		}

		.sk-chase-dot:nth-child(3) {
			animation-delay: -0.9s;
		}

		.sk-chase-dot:nth-child(4) {
			animation-delay: -0.8s;
		}

		.sk-chase-dot:nth-child(5) {
			animation-delay: -0.7s;
		}

		.sk-chase-dot:nth-child(6) {
			animation-delay: -0.6s;
		}

		.sk-chase-dot:nth-child(1):before {
			animation-delay: -1.1s;
		}

		.sk-chase-dot:nth-child(2):before {
			animation-delay: -1.0s;
		}

		.sk-chase-dot:nth-child(3):before {
			animation-delay: -0.9s;
		}

		.sk-chase-dot:nth-child(4):before {
			animation-delay: -0.8s;
		}

		.sk-chase-dot:nth-child(5):before {
			animation-delay: -0.7s;
		}

		.sk-chase-dot:nth-child(6):before {
			animation-delay: -0.6s;
		}

		@keyframes sk-chase {
			100% {
				transform: rotate(360deg);
			}
		}

		@keyframes sk-chase-dot {

			80%,
			100% {
				transform: rotate(360deg);
			}
		}

		@keyframes sk-chase-dot-before {
			50% {
				transform: scale(0.4);
			}

			100%,
			0% {
				transform: scale(1.0);
			}
		}

		#upload {
			position: absolute;
			left: 0;
			top: 0;
			opacity: 0;
		}

		#upload_btn {
			margin-right: 5px;
		}

		a {
			text-decoration: none;
		}

		.iconfont {
			font-family: "iconfont" !important;
			font-size: 16px;
			font-style: normal;
			-webkit-font-smoothing: antialiased;
			-moz-osx-font-smoothing: grayscale;
		}

		.links .iconfont {
			padding: 0 5px;
		}

		.links .iconfont:hover {
			background-color: transparent;
		}

		.links .iconfont {
			font-size: 2em;
		}

		.icon-facebook:before {
			content: "\e87f";
		}

		.icon-twitter:before {
			content: "\e88a";
		}

		.iconfont {
			color: #161209;
			text-decoration: none;
			transition: color 0.2s ease, border-color 0.2s ease, background 0.2s ease, opacity 0.2s ease;
			cursor: pointer;
		}

		.iconfont:hover {
			color: #2d96bd;
			text-decoration: none;
			transition: color 0.2s ease, border-color 0.2s ease, background 0.2s ease, opacity 0.2s ease;
		}

		@font-face {
			font-family: "iconfont";
			src:
				/* IE9 */
				url('iconfont.eot?t=1585328536727');
			src:
				/* IE6-IE8 */
				url('iconfont.eot?t=1585328536727#iefix') format('embedded-opentype'),
				url('data:application/x-font-woff2;charset=utf-8;base64,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') format('woff2'),
				url('iconfont.woff?t=1585328536727') format('woff'),
				/* chrome, firefox, opera, Safari, Android, iOS 4.2+ */
				url('iconfont.ttf?t=1585328536727') format('truetype'),
				/* iOS 4.1- */
				url('iconfont.svg?t=1585328536727#iconfont') format('svg');

		}

		@keyframes spin {
			0% {
				transform: rotate(0deg);
			}

			100% {
				transform: rotate(360deg);
			}
		}
	</style>
</head>

<body>
	<div class="loader" id="loader">
		<div class="sk-chase">
			<div class="sk-chase-dot"></div>
			<div class="sk-chase-dot"></div>
			<div class="sk-chase-dot"></div>
			<div class="sk-chase-dot"></div>
			<div class="sk-chase-dot"></div>
			<div class="sk-chase-dot"></div>
		</div>
	</div>

	<div class="form-container">
		<h1>LIFF Card Share</h1>
		<h3 id="readCount" style="height: 10px;"></h3>
		<div class="chatbox">
			<div id="flex2html"></div>
		</div>
	</div>

	<script>
		var mainTitle_1, mainTitle_2, subTitle_1, subTitle_2, textContent_1, textContent_1_url, textContent_2, textContent_2_url, textContent_3, textContent_3_url, companyUnit, share_card, keep_card, cardDescription, bgColor, textColor
		var flexJson, userId;

		function create_flex(data_card) {
			mainTitle_1 = data_card.mainTitle_1 || "磊山 人文講堂";
			mainTitle_2 = data_card.mainTitle_2 || "《牽風箏的人》";
			subTitle_1 = data_card.subTitle_1 || "余浩瑋";
			subTitle_2 = data_card.subTitle_2 || "青藝盟盟主";
			textContent_1 = data_card.textContent_1 || "05/06(六)09:50~12:00";
			textContent_1_url = data_card.textContent_1_url || "https://cardoa.saasou.com/_files/0/100/f/01_1_cafe.png";
			textContent_2 = data_card.textContent_2 || "磊山學院";
			textContent_2_url = data_card.textContent_2_url || "https://linecorp.com/";
			textContent_3 = data_card.textContent_3 || "台北市南京東路二段178號10樓";
			textColor = data_card.textColor || "#081F58FF";

			flexJson = {
				"type": "flex",
				"altText": "Flex Message",
				"contents": {
					"type": "carousel",
					"contents": [{
						"type": "bubble",
						"hero": {
							"type": "image",
							"url": textContent_1_url,
							"size": "full",
							"aspectRatio": "1:1",
							"aspectMode": "cover",
							"action": {
								"type": "uri",
								"uri": textContent_2_url
							}
						},
						"body": {
							"type": "box",
							"layout": "vertical",
							"position": "relative",
							"height": "355px",
							"contents": [
								{
									"type": "box",
									"layout": "vertical",
									"backgroundColor": textColor,
									"cornerRadius": "5px",
									"contents": [
										{
											"type": "text",
											"text": "【" + mainTitle_1 + "】",
											"weight": "bold",
											"size": "xl",
											"color": "#FFFFFFFF",
											"align": "center",
											"gravity": "center",
											"contents": []
										}
									]
								},
								{
									"type": "box",
									"layout": "horizontal",
									"offsetTop": "5px",
									"height": "45px",
									"contents": [
										{
											"type": "text",
											"text": subTitle_1,
											"weight": "bold",
											"size": "xl",
											"color": textColor,
											"flex": 4,
											"gravity": "center",
											"contents": []
										},
										{
											"type": "text",
											"text": subTitle_2,
											"weight": "bold",
											"color": textColor,
											"flex": 8,
											"gravity": "center",
											"contents": []
										}
									]
								},
								{
									"type": "text",
									"text": mainTitle_2,
									"weight": "regular",
									"color": textColor,
									"contents": []
								},
								{
									"type": "text",
									"text": "時間:" + textContent_1,
									"weight": "regular",
									"color": textColor,
									"contents": []
								},
								{
									"type": "text",
									"text": "地點:" + textContent_2,
									"weight": "regular",
									"color": textColor,
									"contents": []
								},
								{
									"type": "text",
									"text": "(" + textContent_3 + ")",
									"weight": "regular",
									"size": "sm",
									"color": textColor,
									"contents": []
								},
								{
									"type": "box",
									"layout": "horizontal",
									"position": "absolute",
									"offsetTop": "200px",
									"offsetStart": "10px",
									"width": "10000px",
									"contents": [
										{
											"type": "box",
											"layout": "vertical",
											"paddingTop": "10px",
											"width": "135px",
											"height": "40px",
											"backgroundColor": "#B5B8BDFF",
											"contents": [
												{
													"type": "text",
													"text": "分享給好友",
													"color": "#FFFFFFFF",
													"align": "center",
													"action": {
														"type": "uri",
														"uri": "https://liff.line.me/1660908511-Ol7grGPY/?userId=" + encodeURIComponent(userId)
													},
													"contents": []
												}
											]
										},
										{
											"type": "box",
											"layout": "vertical",
											"offsetStart": "10px",
											"paddingTop": "10px",
											"width": "135px",
											"height": "40px",
											"backgroundColor": "#B5B8BDFF",
											"contents": [
												{
													"type": "text",
													"text": "收藏資訊",
													"color": "#FFFFFFFF",
													"align": "center",
													"contents": []
												}
											]
										}
									]
								},
								{
									"type": "box",
									"layout": "vertical",
									"action": {
										"type": "uri",
										// "uri": "https://3428750.so-buy.com/"
										"uri": "https://calendar.google.com/calendar/u/0/r/eventedit?pli=1&uid=62890calndrlink&sf=1&output=xml&dates=20230603T095000/20230603T120000&ctz=Asia/Taipei&text=【磊山+人文講堂】&details=【公益可以不一樣+成為改變的起點】"
									},
									"position": "absolute",
									"offsetTop": "250px",
									"offsetStart": "10px",
									"paddingTop": "10px",
									"width": "280px",
									"height": "40px",
									"backgroundColor": "#91AFC2FF",
									"contents": [
										{
											"type": "text",
											"text": "設定提醒(google行事曆)",
											"color": "#FFFFFFFF",
											"align": "center",
											"contents": []
										}
									]
								},
								{
									"type": "box",
									"layout": "vertical",
									"action": {
										"type": "uri",
										"uri": "https://3428750.so-buy.com/"
									},
									"position": "absolute",
									"offsetTop": "300px",
									"offsetStart": "10px",
									"paddingTop": "10px",
									"width": "280px",
									"height": "40px",
									"backgroundColor": "#91AFC2FF",
									"contents": [
										{
											"type": "text",
											"text": "製作美美的卡片✨",
											"color": "#FFFFFFFF",
											"align": "center",
											"contents": []
										}
									]
								}
							]
						}
					}
					]
				}
			}
			// 將flexJson繪出到HTML上
			my_flexToHtml()
		}

		function my_flexToHtml() {
			document.getElementById("flex2html").innerHTML = "";
			flex2html('flex2html', flexJson)

			// 將錯誤的 ExXxs 替換為正確的 ExXXs
			var wrongExXxsElements = document.querySelectorAll(".ExXxs");
			wrongExXxsElements.forEach(function (element) {
				element.classList.remove("ExXxs");
				element.classList.add("ExXXs");
			});

			// 將錯誤的 Ex3xl 替換為正確的 Ex3Xl
			var wrongEx3xlElements = document.querySelectorAll(".Ex3xl");
			wrongEx3xlElements.forEach(function (element) {
				element.classList.remove("Ex3xl");
				element.classList.add("Ex3Xl");
			});

			// 將 LySlider 關閉下方捲動軸
			var wrongLySliderElements = document.querySelector(".LySlider");
			wrongLySliderElements.style.webkitOverflowScrolling = "auto";
			wrongLySliderElements.style.overflowX = "visible";

			// 將 chatbox 上方空白縮短
			var wrongchatboxElements = document.querySelector(".chatbox");
			wrongchatboxElements.style.paddingTop = "20px";
		}

		async function sendRequest(status, userId, data_card = "", data = "") {
			if (!status || !userId) {
				alert("向google apps script寄送請求時\n有效參數不足");
				return;
			}
			
			const url = "https://script.google.com/macros/s/AKfycbxKiM76YZI-m_mQUDrmIG7vq9PXI2UP5AQpTPljq61KWh-URhW_bIcKFWKZoeFMRx9Dog/exec";

			try {
				const sendData = { status: status, userId: userId, card: data_card };

				// 將資料轉換成查詢字串
				const queryString = new URLSearchParams(sendData).toString();

				const response = await fetch(`${url}?${queryString}`);
				const responseData = await response.json();

				console.log("Data sent:", sendData);
				console.log("Response:", responseData);
				if (responseData.status === 'first') { return "first"; }
				else if (responseData.status === 'ok') { return responseData; }
				else { alert("向google apps script寄送請求時\n回傳值非ok"); }
			} catch (error) {
				alert("向google apps script寄送請求時\n發生錯誤\n" + error);
			}
		}

		window.onload = function () {
			document.getElementById('loader').style.display = 'flex';
			// 获取查询字符串
			var queryString = window.location.search;
			// 移除问号（?）
			queryString = queryString.slice(1);
			// 创建一个对象来存储参数和对应的值
			var parameters = {};
			// 遍历参数对，将其拆分为参数名和值，并存储到对象中
			queryString.split('&').forEach(pair => {
				const [paramName, paramValue] = pair.split('=').map(decodeURIComponent);
				parameters[paramName] = paramValue;
			});

			userId = parameters["userId"];
			async function send() {
				// 向google sheet發送的增加閱讀數
				await sendRequest("addReadCount", userId);
				// 取得卡片資料
				var responseData = await sendRequest("get", userId);
				if (responseData.status === 'ok') {
					const data_card = JSON.parse(responseData.card);
					create_flex(data_card);
					document.getElementById('readCount').innerHTML = "觀看人數：" + parseInt(responseData.readCount);
					document.getElementById('loader').style.display = 'none';
				}
			}
			send()
		}
	</script>

</body>

</html>
